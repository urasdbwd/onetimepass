<html>
<meta property="og:title" content="Things OTP" />
<meta property="og:site_name" content="Things One Time Password Gen" />
<meta property="og:description"
  content="Things OTP is the first of it's kind. Don't have a phone? No problem at all." />
<center>

  <head>
    <link href='https://fonts.googleapis.com/css?family=Varela Round' rel='stylesheet'>
    <style>
      body {
        font-family: 'Varela Round';
        font-size: 22px;
      }
    </style>
  </head>

  <body>
    <style>
      body {
        background-color: #380356;
      }

      h1 {
        color: purple;
        margin-left: 40px;
      }
    </style>
    <h1>Things 2FA</h1>

    <style>
      button#generate-otp:hover {
        transform: scale(1.1);
        transition: transform 0.5s;
      }
    </style>
    <button id="generate-otp"
      style="background-color: #CCC3E3; border-radius: 10px; height: 30px; width: 100px;">Generate</button>
    <p id="otp-value"></p>

    <script>
    const generateOtpButton = document.getElementById('generate-otp')
    const optv = document.getElementById('otp-value')

window.onload = () => {
  generateOtpButton.addEventListener('click', () => {
    // Prompt the user for their secret key
    const secretKey = prompt('What is your secret key?')

    // Remove all whitespace from the secret key
    const sanitizedSecretKey = secretKey.replace(/\s/g, '')

    // Send the POST request to the '/generate' endpoint
    fetch('/generate', {
      method: 'POST',
      body: JSON.stringify({ secret_key: sanitizedSecretKey }), // stringify the request body
      headers: {
        'Content-Type': 'application/json' // set the Content-Type header
      }
    })

      .then(response => response.json()) // parse the response as JSON
      .then(data => {
        alert(data.otp) // alert the generated OTP
      })
  })
}
    </script>
</center>
</body>

</html>
